<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.63">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-122075277-7","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="NexClipper" href="/opensearch.xml"><title data-react-helmet="true">What is MetricOps? | NexClipper</title><meta data-react-helmet="true" property="og:title" content="What is MetricOps? | NexClipper"><meta data-react-helmet="true" name="description" content="안녕하세요. 넥스클라우드 김진웅입니다."><meta data-react-helmet="true" property="og:description" content="안녕하세요. 넥스클라우드 김진웅입니다."><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="true"><link rel="stylesheet" href="/styles.43045f22.css">
<link rel="preload" href="/styles.fa132206.js" as="script">
<link rel="preload" href="/runtime~main.5b163763.js" as="script">
<link rel="preload" href="/main.fce87712.js" as="script">
<link rel="preload" href="/1.49c0a45f.js" as="script">
<link rel="preload" href="/2.f501d36e.js" as="script">
<link rel="preload" href="/3.77a6170f.js" as="script">
<link rel="preload" href="/ccc49370.1751e4b3.js" as="script">
<link rel="preload" href="/182b6f56.9d200f83.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/NexClipper_200.svg" alt="NexClipper Logo"><strong class="navbar__title">NexClipper</strong></a><a class="navbar__item navbar__link" href="/docs/">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a href="https://github.com/NexClipper/NexClipper" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a></div><div class="navbar__items navbar__items--right"><a href="https://console.nexclipper.io/login" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Service</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">⌘</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/NexClipper_200.svg" alt="NexClipper Logo"><strong class="navbar__title">NexClipper</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/">Docs</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/NexClipper/NexClipper" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a href="https://console.nexclipper.io/login" target="_blank" rel="noopener noreferrer" class="menu__link">Service</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--8 col--offset-2"><article><header><h1 class="margin-bottom--sm blogPostTitle_1mse">What is MetricOps?</h1><div class="margin-vert--md"><time datetime="2020-07-27T00:00:00.000Z" class="blogPostDate_3bQP">July 27, 2020  · 4 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/ddiiwoong" target="_blank" rel="noreferrer noopener"><img src="https://avatars1.githubusercontent.com/u/37430952?v=4" alt="Jinwoong Kim"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/ddiiwoong" target="_blank" rel="noreferrer noopener">Jinwoong Kim</a></h4><small class="avatar__subtitle">NexClipper</small></div></div></header><section class="markdown"><p>안녕하세요. 넥스클라우드 김진웅입니다.</p><p>이번 포스팅에서는 약간 다른 주제를 다뤄보려고 합니다. 개발자 입장에서의 프로메테우스 활용을 고민하다가 아이디어가 있어서 컨셉 정리차도 있고, 실제로 이유는 7월 14–16일에 진행되었던 PromCon 2020 행사에 Lightning Talk 로 5분간 발표를 하게 되었는데 너무 짧은 시간이다 보니 관련된 내용들을 기록에 남기려고 정리했습니다.</p><p>오늘 소개해보려고 하는 컨셉은 간단합니다.</p><blockquote><p><em>MetricOps — 종속적이지 않고 중립성 있게 SLO기반으로 GitOps 기반 배포와 롤백을 통한 서비스 운영</em></p></blockquote><p>따로 언급하지는 않겠지만 다른 상용 솔루션 및 SaaS제품에는 최근 이러한 기능들이 추가되고 있는것 같습니다.</p><p>물론 저희가 만드는 <a href="https://nexclipper.io" target="_blank" rel="noopener noreferrer">NexClipper</a> 로드맵에도 포함 되어있습니다.</p><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="gitops"></a>GitOps<a aria-hidden="true" tabindex="-1" class="hash-link" href="#gitops" title="Direct link to heading">#</a></h3><p>기본적인 컨셉은 GitOps에서 출발합니다.</p><p>참고 : <a href="https://www.weave.works/technologies/gitops/" target="_blank" rel="noopener noreferrer">https://www.weave.works/technologies/gitops/</a></p><p><img src="/assets/images/1*LHiE-WSmnBzE7XR4q85iEw-30a6a2922c21ebc6e7695e34669b81e5.png"></p><p>GitOps Pipeline</p><p>자세한 내용은 <a href="https://coffeewhale.com/kubernetes/gitops/argocd/2020/02/10/gitops-argocd/" target="_blank" rel="noopener noreferrer">커피고래님 블로그</a>에 한글로 설명이 잘 되어 있습니다.</p><p>참고 : <a href="https://coffeewhale.com/kubernetes/gitops/argocd/2020/02/10/gitops-argocd/" target="_blank" rel="noopener noreferrer">https://coffeewhale.com/kubernetes/gitops/argocd/2020/02/10/gitops-argocd/</a></p><p>간단하게 정리를 해보면 GitOps의 장점은 아래와 같다고 말할 수 있습니다.</p><ul><li>단일한 Source에서의 단일한 방법으로 배포</li><li>항상 원천의 상태를 완벽히 반영하기 때문에 운영환경이 아닌 원천만 살펴 본다.</li><li>git 저장소를 SSOT(Single source of truth)로 사용하여 GitOps의 구현체 (ArgoCD, Flux등)를 활용해서 운영환경에 변경 사항을 배포하는 것</li><li>쿠버네티스와 같은 선언형 명령(declarative description)을 통해 Git 저장소에 배포형태를 선언하면 그것을 운영환경에 반영</li></ul><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="slo"></a>SLO<a aria-hidden="true" tabindex="-1" class="hash-link" href="#slo" title="Direct link to heading">#</a></h3><p><strong>SLO</strong>라고 하는 용어는 <strong>SLI</strong>, <strong>SLA</strong>와 함께 많이들 들어 보셨을텐데요.</p><p>(참고 : <a href="https://landing.google.com/sre/sre-book/chapters/service-level-objectives/" target="_blank" rel="noopener noreferrer">https://landing.google.com/sre/sre-book/chapters/service-level-objectives/</a>)</p><p>서비스를 오픈하고 서비스 상태를 식별하는 지표(일반적으로 http_request_count 와 같은 메트릭 지표)를 정하고 나면 고객이나 우리가 원하는 안정성 수준을 결정해야 합니다. 개발팀과 운영팀이 같이 만든 원하는 안정성 수준을 <strong>SLO</strong>(서비스 수준 목표)라고 합니다.</p><p><strong>SLO</strong>는 Prometheus나 Datadog과 같은 모니터링 시스템을 활용하여 정확하게 측정하고 표시해야 합니다. 서비스의 안정성에 대해서 명확하게 이해할수 있는 목표이기도 합니다. 반드시 <strong>SLO</strong>를 만족하는지 못하는지 명확한 측정값으로 데이터가 존재해야 하고 <strong>SLO</strong>를 충족하지 못하면 문제가 있는것으로 판단하고 문제를 해결해야 합니다.</p><p>기존에 Prometheus Adapter를 활용하여 Custom Metric으로 HPA(Horizontal Pod Autoscaling)을 구현하는 튜토리얼이나 컨셉은 많이 있었습니다.</p><p>용찬호님 블로그 : <a href="https://blog.naver.com/alice_k106/221521978267" target="_blank" rel="noopener noreferrer">https://blog.naver.com/alice_k106/221521978267</a></p><p>문진수님 발표자료 : <a href="https://www.slideshare.net/jinsumoon33/kubernetes-prometheus-monitoring" target="_blank" rel="noopener noreferrer">https://www.slideshare.net/jinsumoon33/kubernetes-prometheus-monitoring</a></p><p>제가 여기서 좀더 나아가고자 한건 애플리케이션을 배포하고 난 이후의 운영단계에서의 SLO기반으로 관리를 하는 컨셉을 고민하고 있습니다.</p><p>AlertRule을 SLO기반으로 생성해주는 웹 기반 도구 : <a href="https://promtools.dev/" target="_blank" rel="noopener noreferrer">https://promtools.dev/</a></p><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="cdcontinuous-delivery"></a>CD(Continuous Delivery)<a aria-hidden="true" tabindex="-1" class="hash-link" href="#cdcontinuous-delivery" title="Direct link to heading">#</a></h3><p>주로 운영상황에서 배포에 관련된 내용이니 Continuous Delivery(지속적 전달) 관련한 이야기를 해보겠습니다.</p><p>지속적 전달은 지속적 통합(CI: Continuous Integration)단계에서 빌드가 완료된 최종 패키지와 애플리케이션 패키지를 테스트와 스테이징, 프로덕션과 같은 다양한 운영 환경에 배포까지 진행하는 과정이라 할 수 있습니다.</p><p>이미 많이 알고 계시고 관련한 블로그도 많으니 여기서 간단하게 정리하기로 하고</p><p>CD.FOUNDATION 를 소개 드리고자 합니다.</p><p><a href="https://cd.foundation/" target="_blank" rel="noopener noreferrer">https://cd.foundation/</a></p><p>CD.FOUNDATION는 Linux Foundation 산하에 있는 독립적인 기관으로 다양한 CI/CD를 위해 2019년 3월에 만들어진 재단입니다.</p><p><a href="https://landscape.cd.foundation/" target="_blank" rel="noopener noreferrer">https://landscape.cd.foundation/</a></p><p><img src="/assets/images/1*uYO-hIQ0zJcIVWgbVWTO7Q-54605e3d3bcea3c37bb1a06e03876eb9.png"></p><p>CD Landscape</p><p>다들 Jenkins는 사용해보셨거나 사용중이실걸로 알고 있습니다. Jenkins와 몇가지 OpenSource기반의 CD 플랫폼이 해당 재단에 가입되어 있고 많은 글로벌 멤버사들이 후원 및 표준을 위해 참여를 하고 있습니다.</p><p><a href="http://cd.foundation" target="_blank" rel="noopener noreferrer">cd.foundation</a> 웹사이트나 <a href="https://landscape.cd.foundation/" target="_blank" rel="noopener noreferrer">https://landscape.cd.foundation/</a> 랜드스케이프쪽에 가시면 여러 멤버사들을 보실수 있는데 현재 가장 메인이 되는 프로젝트는 Jenkins, JenkinsX, Spinnaker, Tekton 등이 있습니다. 예전에 개인 블로그에서 Spinnaker 관련한 내용을 연재한 적이 있는데 지금은 또 다른 환경으로 변화해가고 있습니다.</p><p><a href="https://ddii.dev/kubernetes/spinnaker-advanced-1/" target="_blank" rel="noopener noreferrer">https://ddii.dev/kubernetes/spinnaker-advanced-1/</a></p><p><a href="https://ddii.dev/kubernetes/spinnaker-advanced-2/" target="_blank" rel="noopener noreferrer">https://ddii.dev/kubernetes/spinnaker-advanced-2/</a></p><p><a href="https://ddii.dev/kubernetes/spinnaker-advanced-3/" target="_blank" rel="noopener noreferrer">https://ddii.dev/kubernetes/spinnaker-advanced-3/</a></p><p>18년도에 남긴 3번째 포스팅에 보면 kayenta라는 Automated Canary Analysis (ACA) 오픈소스에 관련된 내용도 참고하시면 좋을 것 같습니다.</p><p>MetricOps 컨셉은 아래 영상을 참고하시기 바랍니다.</p><p>[embed]<a href="https://www.youtube.com/embed/xOya8uWrVk0%5C%5B/embed%5C%5D" target="_blank" rel="noopener noreferrer">https://www.youtube.com/embed/xOya8uWrVk0\[/embed\]</a></p><p>PromCon Online 2020 — Lightning Talks Day2, MetricOps</p><hr><p>제가 구현해 보려는 컨셉은 다음과 같습니다.</p><ul><li>기존에 GitOps 형태로 코드를 배포</li><li>Python prometheus client로 metric expose, prometheus에서 수집, 모니터링</li><li>Feedback Pipeline(가칭) 앱 배포 : kube-api에 rollback 명령 전달용 Container</li><li>배포시 정보를 전달하기 위한 Mutation Admission Webhook container 배포</li><li>개인 블로그 : <a href="https://ddii.dev/kubernetes/mutating-web-hook/#" target="_blank" rel="noopener noreferrer">https://ddii.dev/kubernetes/mutating-web-hook/#</a> 용찬호님 블로그 : <a href="https://m.blog.naver.com/alice_k106/221546328906" target="_blank" rel="noopener noreferrer">https://m.blog.naver.com/alice_k106/221546328906</a></li><li>해당 컨테이너는 배포시점의 Image Tag, TimeStamp, Label, Rule 정보를 Feedback Pipeline API로 전달</li><li>Rule 정보는 배포하는 담당자가 정의 예) <code>rate(http_request_total{code=~&quot;^5.*$&quot;}[5m]) &gt;0</code> 5xx에러가 5분 window내 한번 이상 발생하는 경우</li><li>Feedback Pipeline 앱이 해당 alertrule 을 모니터링 하다가 Firing 상태가 될 경우 rollout undo API로 이전 버전으로 rollback</li></ul><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="정리"></a>정리<a aria-hidden="true" tabindex="-1" class="hash-link" href="#정리" title="Direct link to heading">#</a></h3><p>현재 CI/CD는 SaaS와 오픈소스를 포함한 솔루션이 난립하고 있는 형국으로, Jenkins, JenkinX와 같이 오래되기도 했고 유저층이 두터운 솔루션과, 최근 몇년간 구글과 넷플릭스, 삼성전자 같은 대기업 주도로 spinnaker와 같은 도구가 유행을 했다면 최근에는 중소팀이나 스타트업, 오픈소스 분야에서는 CircleCI, Github Action, Tekton, Skaffold과 같은 pipeline 형태의 도구들이 유행하기도 했습니다. 하지만 점점 복잡해지는 환경에서 ArgoCD 와 같은 선언형(declarative) 도구가 트렌드를 주도하고 있습니다. 언제나 배포는 운영자의 입장에서 가장 고통스러우면서 설레는 일입니다. 이런 scaling 뿐만 아닌 rollback 이나 Feedback 정보를 투명하게 누구나 볼 수 있으면 좋지 않을까 하는 생각에서 포스팅을 작성 해봤습니다.</p><p>마지막으로 현재 NexCloud에서는 OSS기반으로 개발 중인 NexClipper Cloud 서비스와 Exporter Catalog 관련 서비스를 연동해서 사용할 Exporter를 탐색, 생성하는 기능을 연동하는 기능을 9월 정도에 출시할 예정입니다.</p><p>궁금하시면 언제든지 연락주시고 찾아뵙거나 화상으로도 제품소개가 가능합니다.</p><p>많은 기대 부탁드립니다.</p><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="넥스클라우드-소개-및-채용"></a>넥스클라우드 소개 및 채용<a aria-hidden="true" tabindex="-1" class="hash-link" href="#넥스클라우드-소개-및-채용" title="Direct link to heading">#</a></h3><p><a href="https://www.nexclipper.io/" target="_blank" rel="noopener noreferrer">넥스클라우드</a>는 컨테이너 기반 클라우드 기술 회사입니다.</p><p>2020년 하반기부터 본격적인 글로벌 사업을 위해 현재 미국 법인 설립을 진행 중이며 능력있는 분들을 모시고 있습니다.</p><p><a href="https://www.notion.so/nexclipper/Engineer-a83352e7b6a24bbbb1ac77bf83a7026b" target="_blank" rel="noopener noreferrer">개발자 (Engineer) 부문</a> (Front-End)</p><p><a href="https://www.notion.so/nexclipper/Job-description-63e5113b79a943f28a75c1eca1e0f50a" target="_blank" rel="noopener noreferrer">Product Marketing Manager</a></p><p><a href="https://www.notion.so/nexclipper/Cloud-Platform-Consulting-Manager-871f792b04994afeb40984dbe05da386" target="_blank" rel="noopener noreferrer">Cloud Platform Consulting Manager</a></p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/prometheus">Prometheus</a><a class="margin-horiz--sm" href="/blog/tags/metric-ops">MetricOps</a></div></footer></article><div><a href="https://github.com/NexClipper/docs/edit/master/blog/blog/2020-07-27-what-is-metricops.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="margin-vert--xl"><nav class="pagination-nav" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2020/08/13/cloud-native-102-the-12-factor-app-1"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">« Cloud-native 102: 경험을 기반으로 해석한 The 12-factor app #1</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2020/07/17/cloud-difference"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">은유적으로 알아보는 클라우드와 클라우드-네이티브의 차이 »</div></a></div></nav></div></div><div class="col col--2"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#gitops" class="table-of-contents__link">GitOps</a></li><li><a href="#slo" class="table-of-contents__link">SLO</a></li><li><a href="#cdcontinuous-delivery" class="table-of-contents__link">CD(Continuous Delivery)</a></li><li><a href="#정리" class="table-of-contents__link">정리</a></li><li><a href="#넥스클라우드-소개-및-채용" class="table-of-contents__link">넥스클라우드 소개 및 채용</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/doc2/">API Reference</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="http://nexclipper.slack.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://twitter.com/nexclipper" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://www.facebook.com/NexClipper/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/NexClipper/NexClipper" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyright © 2020 NexCloud, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.fa132206.js"></script>
<script src="/runtime~main.5b163763.js"></script>
<script src="/main.fce87712.js"></script>
<script src="/1.49c0a45f.js"></script>
<script src="/2.f501d36e.js"></script>
<script src="/3.77a6170f.js"></script>
<script src="/ccc49370.1751e4b3.js"></script>
<script src="/182b6f56.9d200f83.js"></script>
</body>
</html>