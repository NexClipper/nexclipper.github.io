<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.72">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="NexClipper Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="NexClipper Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-122075277-7","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="NexClipper" href="/opensearch.xml"><title data-react-helmet="true">Prometheus at NexClipper | NexClipper</title><meta data-react-helmet="true" property="og:title" content="Prometheus at NexClipper | NexClipper"><meta data-react-helmet="true" name="description" content="Summarize the issues that arise in operating Prometheus at the enterprise level and introduce NexClipper&#x27;s development roadmap to solve them."><meta data-react-helmet="true" property="og:description" content="Summarize the issues that arise in operating Prometheus at the enterprise level and introduce NexClipper&#x27;s development roadmap to solve them."><meta data-react-helmet="true" property="og:url" content="https://nexclipper.github.io/blog/2020/11/09/prometheus-at-nexcilpper"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="default"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://nexclipper.github.io/blog/2020/11/09/prometheus-at-nexcilpper"><link data-react-helmet="true" rel="alternate" href="https://nexclipper.github.io/blog/2020/11/09/prometheus-at-nexcilpper" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://nexclipper.github.io/blog/2020/11/09/prometheus-at-nexcilpper" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.f05b8c39.css">
<link rel="preload" href="/assets/js/styles.b940239e.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.a75c165e.js" as="script">
<link rel="preload" href="/assets/js/main.ce7cbbc7.js" as="script">
<link rel="preload" href="/assets/js/1.39fe5ba9.js" as="script">
<link rel="preload" href="/assets/js/2.4ed13a0e.js" as="script">
<link rel="preload" href="/assets/js/3.da77e9d3.js" as="script">
<link rel="preload" href="/assets/js/ccc49370.ded46c27.js" as="script">
<link rel="preload" href="/assets/js/4f24731d.8ffe43af.js" as="script">
<link rel="preload" href="/assets/js/a9f08677.73f8bf4a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/NexClipper_200.svg" alt="NexClipper Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/NexClipper_200.svg" alt="NexClipper Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">NexClipper</strong></a><a class="navbar__item navbar__link" href="/docs/">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a href="https://NexClipper.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Support</a></div><div class="navbar__items navbar__items--right"><a href="https://console.nexclipper.io/login" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Get Started</a><a href="https://github.com/NexClipper/NexClipper" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_GrZ2"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/NexClipper_200.svg" alt="NexClipper Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/NexClipper_200.svg" alt="NexClipper Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">NexClipper</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/">Docs</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://console.nexclipper.io/login" target="_blank" rel="noopener noreferrer" class="menu__link">Get Started</a></li><li class="menu__list-item"><a href="https://github.com/NexClipper/NexClipper" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub repository"></a></li><li class="menu__list-item"><a href="https://NexClipper.io" target="_blank" rel="noopener noreferrer" class="menu__link">Support</a></li></ul></div></div></div></nav><div class="main-wrapper blog-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--3"><div class="sidebar_2ahu thin-scrollbar"><h3 class="sidebarItemTitle_2hhb">Recent posts</h3><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/03/22/values-of-nexcilpper-eng">Simple way to manage your observability stack with NexClipper</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/03/22/values-of-nexcilpper">NexClipper의 가치</a></li><li class="sidebarItem_2UVv"><a aria-current="page" class="sidebarItemLink_1RT6 sidebarItemLinkActive_12pM" href="/blog/2020/11/09/prometheus-at-nexcilpper">Prometheus at NexClipper</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2020/09/25/prometheus-exporter-exporterhub-en">Prometheus Exporter &amp; ExporterHub (Eng.)</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2020/09/03/prometheus-exporter-exporterhub">Prometheus Exporter &amp; ExporterHub</a></li></ul></div></div><main class="col col--7"><article><header><h1 class="margin-bottom--sm blogPostTitle_GeHD">Prometheus at NexClipper</h1><div class="margin-vert--md"><time datetime="2020-11-09T00:00:00.000Z" class="blogPostDate_fNvV">November 9, 2020 · 7 min read</time></div><div class="avatar margin-vert--md"><a href="https://github.com/ddiiwoong" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://avatars1.githubusercontent.com/u/37430952?v=4" alt="Jinwoong Kim"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/ddiiwoong" target="_blank" rel="noopener noreferrer">Jinwoong Kim</a></h4><small class="avatar__subtitle">NexClipper</small></div></div></header><div class="markdown"><p>In this post, I summarize the issues that arise in operating Prometheus at the enterprise level and introduce NexClipper&#x27;s development roadmap to solve them.</p><h2 id="overview-for-monitoring-kubernetes">Overview for Monitoring Kubernetes</h2><p>Kubernetes is the first project to graduate from the Cloud Native Computing Foundation (CNCF), and it is currently the de facto standard for container orchestration, encompassing IaaS and PaaS, and has grown tremendously in just a few years, revitalizing the community, and many companies have adopted it in real production environments.</p><p><a href="https://github.com/kubernetes/community/blob/master/contributors/design-proposals/instrumentation/monitoring_architecture.md#architecture">https://github.com/kubernetes/community/blob/master/contributors/design-proposals/instrumentation/monitoring_architecture.md#architecture</a>  </p><p>The basic Kubernetes metric description is divided into system metrics and service metrics, and monitoring methods are largely divided into core metric pipeline and monitoring pipeline.</p><p>Initially, Heapster was widely used together with Kubernetes as a monitoring solution, as indicated in that document. It started as a tool that transmits monitoring data to an external system, and has since grown into its own monitoring system. However, Heapster was deprecated in Kubernetes version 1.11, and most components of Kubernetes clusters after 1.13 are supported by Prometheus to measure in cloud native way.</p><h2 id="prometheus-components">Prometheus Components</h2><p>Kubernetes monitoring is based on cluster monitoring by default. As you monitor your cluster, you can get information about the overall health and workloads of the system, such as checking the utilization of nodes and the number of pods running. Next, we describe the services and tools most used among the various ecosystems.  </p><ul><li>Prometheus : Open source time series database</li><li>kube-state-metric : Service that generates metrics information of various objects and workloads in Kubernetes cluster</li><li>Node_exporter : Service that generates hardware and OS metric information exposed by the *NIX kernel</li><li>Pushgateway : Receive and provide metrics for ad-hoc and small batch jobs</li><li>Alertmanager : Service that handles (deduplication, grouping, and sending) notifications sent from Prometheus server</li><li>Grafana : Dashboard visualization tool for monitoring and metric analysis</li></ul><h2 id="how-to-install-prometheus">How to install Prometheus</h2><p>Installing Prometheus is not difficult. However, using Prometheus with a complete understanding or just deploying it with Getting Started is very different for an actual operation in the future.  </p><p>There are mainly two ways to configure it by yourself. You can run the already compiled binary or build the source yourself and install it using Docker. In addition, it can be installed using configuration management tools such as Ansible and Puppet.</p><ul><li><a href="https://prometheus.io/docs/prometheus/latest/installation/">https://prometheus.io/docs/prometheus/latest/installation/</a></li></ul><p>The Prometheus community basically provides Helm Charts in beta.  </p><p>You can simply deploy Alertmanager and Prometheus alone, or simply use it for deploying various exporters.  </p><ul><li><a href="https://github.com/prometheus-community/helm-charts">https://github.com/prometheus-community/helm-chart</a></li></ul><p>Prometheus Operators use <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">Custom Resources</a> by default to simplify deployment and configuration of Prometheus, Alert Manager, and related ecosystems.  </p><ul><li><a href="https://github.com/prometheus-operator/prometheus-operator">https://github.com/prometheus-operator/prometheus-operator</a></li></ul><p>Alternatively, it can be deployed through the kube-prometheus-stack helm chart that includes the operator above.</p><ul><li><a href="https://github.com/prometheus-operator/kube-prometheus">https://github.com/prometheus-operator/kube-prometheus</a></li></ul><h2 id="advantages-of-using-prometheus">Advantages of using Prometheus</h2><p>There are several advantages to using Prometheus as a monitoring tool for Kubernetes.</p><ul><li>Ease of management: The key to Prometheus is that it is easy to manage. Since it operates as a single binary file without separate installation, it basically only needs a local disk and has few dependencies with other solutions such as database or cache.</li><li>Service Discovery: Basically, file or DNS-based service discovery can be configured, so the target to be scraped is basically registered through the DNS domain name that is periodically queried. In the Kubernetes REST API, you can search for what to scrap and stay in sync with your Kubernetes cluster at all times.</li></ul><p><a href="https://prometheus.io/docs/prometheus/latest/configuration/configuration/#kubernetes_sd_config">https://prometheus.io/docs/prometheus/latest/configuration/configuration/#kubernetes_sd_config</a></p><ul><li><p>Powerful and easy data model: All collected monitoring data is stored in metric format in the built-in time series database (TSDB). And in addition to the default name, every sample contains a set of tags that describe the characteristics of the sample. Each time series data is uniquely identified by a metric name and a key-value pair called an optional label. Each time series data stores a series of sample values ​​in chronological order. Each sample consists of a float64 value and a timestamp in milliseconds.</p></li><li><p>Query Language (PromQL): Easily query and aggregate monitoring data based on labels and time series. You can apply functions and operators to metric queries, filter and group by label, and even use regular expressions for matching and filtering. PromQL is also used for data visualization or alerts, notifications such as Grafana.</p></li><li><p>Monitoring internal status by pull collection method: Prometheus recommends that users monitor the internal status of the service themselves. You can check the metric status of the actual application or solution using various client libraries or exporters.</p></li></ul><h2 id="cons-of-prometheus">Cons of Prometheus</h2><ul><li>Long-term storage: Basically, if 100,000 metrics of 3 byte size are stored per second, about 500 GB of storage is used in 30 days. If Prometheus is operated in the form of a local instance or Pod, long-term storage is not easy, and the more monitoring targets, the more data is stored.</li><li>Data source redundancy: When Prometheus is installed and operated in multiple clusters, it is not easy to manage in terms of data sources, and when a dashboard such as Grafana is configured, it is difficult to distinguish when querying multiple clusters for the same metric. Because of this, when Prometheus is installed for each cluster, it is difficult to see the data integrated.</li><li>It lacks group management and user authentication management (security).</li><li>Raw log/event collection is not possible.</li><li>Application-based request tracing is not supported by itself.</li><li>Additional data analysis capability is required for Anomaly Detection.</li><li>Complicated configuration for horizontal scaling and high availability.</li><li>It takes a lot of labor and effort to distribute and operate. (Learn PromQL, configure Grafana dashboard, create Alert-Rule, etc.)</li></ul><h2 id="nexclipper">NexClipper</h2><p>NexClipper is under development with the following roadmap to solve the problems the current Prometheus ecosystem has. We are working hard to add new features while maintaining our existing open source and solutions.</p><p><img alt="architect" src="/assets/images/nexclipper_architect-78e0205e7a7716f0d1383230db35a37a.png"></p><p>The following features are currently being developed.</p><p>Prometheus ecosystem can be quickly and easily deployed in any production environment. (<a href="https://github.com/NexClipper/provbee">https://github.com/NexClipper/provbee</a>)  </p><ul><li>NexClipper Cloud allows you to quickly and easily deploy Prometheus ecosystem through a simple installation command.</li><li>NexClipper On-Premise provides a separate Prometheus server cluster and various ecosystem installation and operation environments in multiple multi-cloud environments.</li><li>Long-term storage can be configured based on open source softwares. (Avoiding vendor dependency)</li><li>Provisioned based on PromScale, which is basically composed of TimescaleDB, and storage period and capacity can be increased whenever necessary.</li></ul><p>Similar to the Bastion Host role, even in a blocking environment such as a firewall, the open source-based Task Manager(<a href="https://github.com/NexClipper/klevr">https://github.com/NexClipper/klevr</a>) executes asynchronous jobs, so it can be operated in a private cloud environment.  </p><ul><li>Separate charts or resources can be directly distributed, and operation is possible in a private environment that is isolated for security reasons.</li><li>Cluster management or operation is possible without direct access to KubeAPI.</li><li>Remotely modify and manage Prometheus and AlertManager config.</li></ul><p>NexClipper provides convenient functions related to queries and rules.</p><ul><li>Multiple Prometheus instances can be queried simultaneously to a single endpoint and multi-cluster Graphana dashboards can be operated while minimizing the movement of multiple data sources.</li><li>Promlens(<a href="https://github.com/promlabs/promlens-public">https://github.com/promlabs/promlens-public</a>) Preview features are included so you can write and test simple queries.</li><li>With the ability to manage exporters, you can easily install and configure AlertRule for operation. <a href="https://ExporterHub.io">ExporterHub.io</a>, <a href="https://github.com/NexClipper/exporterhub.io">https://github.com/NexClipper/exporterhub.io</a></li></ul><p>We are working hard to provide many other features.</p><h2 id="summary">Summary</h2><p>In this post, explained monitoring in the Kubernetes environment, the pros and cons of Prometheus, and the roadmap of NexClipper to overcome the drawbacks of Prometheus.  </p><p>If you have any questions or would like to have additional information, please visit KubeCon North America 2020 NexClipper Booth.</p><p>We appreciate all your feedbacks on all our technologies and products, including blog content, and if you have any questions at any time, please contact us at <a href="mailto:support@nexclipper.io">support@nexclipper.io</a> and we will reply as soon as possible.</p><h2 id="introduce-nexcloud-and-career">Introduce NexCloud and Career</h2><p><a href="https://www.nexclipper.io/">NexCloud</a> is a container-based cloud technology company.
We’re planning to kick-start our US operations in early 2021, and looking for talents to grow with the company.  </p><p><a href="https://www.notion.so/nexclipper/Job-description-63e5113b79a943f28a75c1eca1e0f50a">Product Marketing Manager</a></p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/prometheus">Prometheus</a><a class="margin-horiz--sm" href="/blog/tags/exporter">Exporter</a><a class="margin-horiz--sm" href="/blog/tags/nex-clipper">NexClipper</a></div></footer></article><div><a href="https://github.com/NexClipper/docs/edit/master/blog/blog/2020-11-09-prometheus-at-nexcilpper.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="margin-vert--xl"><nav class="pagination-nav" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2021/03/22/values-of-nexcilpper"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">« NexClipper의 가치</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2020/09/25/prometheus-exporter-exporterhub-en"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Prometheus Exporter &amp; ExporterHub (Eng.) »</div></a></div></nav></div></main><div class="col col--2"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview-for-monitoring-kubernetes" class="table-of-contents__link">Overview for Monitoring Kubernetes</a></li><li><a href="#prometheus-components" class="table-of-contents__link">Prometheus Components</a></li><li><a href="#how-to-install-prometheus" class="table-of-contents__link">How to install Prometheus</a></li><li><a href="#advantages-of-using-prometheus" class="table-of-contents__link">Advantages of using Prometheus</a></li><li><a href="#cons-of-prometheus" class="table-of-contents__link">Cons of Prometheus</a></li><li><a href="#nexclipper" class="table-of-contents__link">NexClipper</a></li><li><a href="#summary" class="table-of-contents__link">Summary</a></li><li><a href="#introduce-nexcloud-and-career" class="table-of-contents__link">Introduce NexCloud and Career</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/start">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/">What is NexClipper?</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="http://nexclipper.slack.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://twitter.com/nexclipper" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://www.facebook.com/NexClipper/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/NexClipper/NexClipper" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a class="footer__link-item" href="/license">Open Source License</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 NexCloud, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/styles.b940239e.js"></script>
<script src="/assets/js/runtime~main.a75c165e.js"></script>
<script src="/assets/js/main.ce7cbbc7.js"></script>
<script src="/assets/js/1.39fe5ba9.js"></script>
<script src="/assets/js/2.4ed13a0e.js"></script>
<script src="/assets/js/3.da77e9d3.js"></script>
<script src="/assets/js/ccc49370.ded46c27.js"></script>
<script src="/assets/js/4f24731d.8ffe43af.js"></script>
<script src="/assets/js/a9f08677.73f8bf4a.js"></script>
</body>
</html>